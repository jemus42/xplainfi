<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with xplainfi • xplainfi</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with xplainfi">
<script defer src="https://umami.jemu.name/script.js" data-website-id="248c8668-4908-4c63-86f7-db0a1b19758a"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">xplainfi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/xplainfi.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Method Showcase</h6></li>
    <li><a class="dropdown-item" href="../articles/perturbation-importance.html">Perturbation-Based Methods (PFI, CFI, RFI)</a></li>
    <li><a class="dropdown-item" href="../articles/loco-loci.html">Leave-Out/In Methods (LOCO, LOCI)</a></li>
    <li><a class="dropdown-item" href="../articles/sage-methods.html">Shapley Additive Global Importance (SAGE)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Testing &amp; Validation</h6></li>
    <li><a class="dropdown-item" href="../articles/simulation-settings.html">Simulation Settings</a></li>
    <li><a class="dropdown-item" href="../articles/fippy-comparison.html">Comparison with fippy (Python)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jemus42/xplainfi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Started with xplainfi</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jemus42/xplainfi/blob/main/vignettes/xplainfi.Rmd" class="external-link"><code>vignettes/xplainfi.Rmd</code></a></small>
      <div class="d-none name"><code>xplainfi.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jemus42.github.io/xplainfi/">xplainfi</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mlr3.mlr-org.com" class="external-link">mlr3</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mlr3learners.mlr-org.com" class="external-link">mlr3learners</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>The <strong>xplainfi</strong> package provides feature importance
methods for machine learning models. It implements several approaches
for measuring how much each feature contributes to model predictions,
with a focus on model-agnostic methods that work with any learner.</p>
<div class="section level2">
<h2 id="core-concepts">Core Concepts<a class="anchor" aria-label="anchor" href="#core-concepts"></a>
</h2>
<p>Feature importance methods in xplainfi answer different but related
questions:</p>
<ul>
<li>
<strong>How much does each feature contribute to model
performance?</strong> (Permutation Feature Importance)</li>
<li>
<strong>What happens when we remove features and retrain?</strong>
(Leave-One-Covariate-Out)<br>
</li>
<li>
<strong>How much does each feature contribute individually?</strong>
(Leave-One-Covariate-In)</li>
<li>
<strong>How do features depend on each other?</strong> (Conditional
and Relative methods)</li>
</ul>
<p>All methods share a common interface built on <a href="https://mlr3.mlr-org.com/" class="external-link">mlr3</a>, making them easy to use with
any task, learner, measure, and resampling strategy.</p>
</div>
<div class="section level2">
<h2 id="basic-example">Basic Example<a class="anchor" aria-label="anchor" href="#basic-example"></a>
</h2>
<p>Let’s use the Friedman1 task, which provides an ideal setup for
demonstrating feature importance methods with known ground truth:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">task</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">tgen</a></span><span class="op">(</span><span class="st">"friedman1"</span><span class="op">)</span><span class="op">$</span><span class="fu">generate</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">learner</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">lrn</a></span><span class="op">(</span><span class="st">"regr.ranger"</span>, num.trees <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">measure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">msr</a></span><span class="op">(</span><span class="st">"regr.mse"</span><span class="op">)</span></span>
<span><span class="va">resampling</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">rsmp</a></span><span class="op">(</span><span class="st">"cv"</span>, folds <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>The task has 300 observations with 10 features. Features
<code>important1</code> through <code>important5</code> truly affect the
target, while <code>unimportant1</code> through
<code>unimportant5</code> are pure noise. We’ll use a random forest
learner with cross-validation for more stable estimates.</p>
<p>The target function is: <span class="math inline">\(y = 10 *
\operatorname{sin}(\pi * x_1 * x_2) + 20 * (x_3 - 0.5)^2 + 10 * x_4 + 5
* x_5 + \epsilon\)</span></p>
</div>
<div class="section level2">
<h2 id="permutation-feature-importance-pfi">Permutation Feature Importance (PFI)<a class="anchor" aria-label="anchor" href="#permutation-feature-importance-pfi"></a>
</h2>
<p>PFI is the most straightforward method: for each feature, we permute
(shuffle) its values and measure how much model performance
deteriorates. More important features cause larger performance drops
when shuffled.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pfi</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PFI.html">PFI</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  task <span class="op">=</span> <span class="va">task</span>,</span>
<span>  learner <span class="op">=</span> <span class="va">learner</span>,</span>
<span>  measure <span class="op">=</span> <span class="va">measure</span>,</span>
<span>  resampling <span class="op">=</span> <span class="va">resampling</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pfi_results</span> <span class="op">&lt;-</span> <span class="va">pfi</span><span class="op">$</span><span class="fu">compute</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pfi_results</span></span>
<span><span class="co">#&gt; Key: &lt;feature&gt;</span></span>
<span><span class="co">#&gt;          feature   importance         sd</span></span>
<span><span class="co">#&gt;           &lt;char&gt;        &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:   important1  4.858724892 0.68442453</span></span>
<span><span class="co">#&gt;  2:   important2  8.155693005 2.26484810</span></span>
<span><span class="co">#&gt;  3:   important3  1.109254345 0.69151561</span></span>
<span><span class="co">#&gt;  4:   important4 10.784727349 1.29361802</span></span>
<span><span class="co">#&gt;  5:   important5  2.395793708 0.87273890</span></span>
<span><span class="co">#&gt;  6: unimportant1  0.009618005 0.11138825</span></span>
<span><span class="co">#&gt;  7: unimportant2  0.080903445 0.08050202</span></span>
<span><span class="co">#&gt;  8: unimportant3  0.044057887 0.04528352</span></span>
<span><span class="co">#&gt;  9: unimportant4 -0.082032243 0.10855146</span></span>
<span><span class="co">#&gt; 10: unimportant5 -0.137666350 0.08268950</span></span></code></pre></div>
<p>The <code>importance</code> column shows the performance difference
when each feature is permuted. Higher values indicate more important
features.</p>
<p>For more stable estimates, we can use multiple permutation iterations
per resampling fold:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pfi_stable</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PFI.html">PFI</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  task <span class="op">=</span> <span class="va">task</span>,</span>
<span>  learner <span class="op">=</span> <span class="va">learner</span>,</span>
<span>  measure <span class="op">=</span> <span class="va">measure</span>,</span>
<span>  resampling <span class="op">=</span> <span class="va">resampling</span>,</span>
<span>  iters_perm <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pfi_stable</span><span class="op">$</span><span class="fu">compute</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Key: &lt;feature&gt;</span></span>
<span><span class="co">#&gt;          feature   importance         sd</span></span>
<span><span class="co">#&gt;           &lt;char&gt;        &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:   important1  5.625322621 0.84130375</span></span>
<span><span class="co">#&gt;  2:   important2  9.609986341 1.77518863</span></span>
<span><span class="co">#&gt;  3:   important3  1.196388744 0.44992082</span></span>
<span><span class="co">#&gt;  4:   important4 12.648328883 2.92740759</span></span>
<span><span class="co">#&gt;  5:   important5  1.705056896 0.54745713</span></span>
<span><span class="co">#&gt;  6: unimportant1 -0.002597636 0.09029340</span></span>
<span><span class="co">#&gt;  7: unimportant2  0.108962283 0.17123736</span></span>
<span><span class="co">#&gt;  8: unimportant3  0.039131183 0.08291645</span></span>
<span><span class="co">#&gt;  9: unimportant4 -0.058408934 0.08647166</span></span>
<span><span class="co">#&gt; 10: unimportant5 -0.041202334 0.10787124</span></span></code></pre></div>
<p>We can also use ratio instead of difference for the importance
calculation:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pfi_stable</span><span class="op">$</span><span class="fu">compute</span><span class="op">(</span>relation <span class="op">=</span> <span class="st">"ratio"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Key: &lt;feature&gt;</span></span>
<span><span class="co">#&gt;          feature importance         sd</span></span>
<span><span class="co">#&gt;           &lt;char&gt;      &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:   important1  1.9484469 0.29293110</span></span>
<span><span class="co">#&gt;  2:   important2  2.4425122 0.27894990</span></span>
<span><span class="co">#&gt;  3:   important3  1.2212920 0.07502941</span></span>
<span><span class="co">#&gt;  4:   important4  2.9619275 0.45741386</span></span>
<span><span class="co">#&gt;  5:   important5  1.3790643 0.13580065</span></span>
<span><span class="co">#&gt;  6: unimportant1  0.9862282 0.01836363</span></span>
<span><span class="co">#&gt;  7: unimportant2  1.0098376 0.01946505</span></span>
<span><span class="co">#&gt;  8: unimportant3  1.0227458 0.01668362</span></span>
<span><span class="co">#&gt;  9: unimportant4  1.0090616 0.01819052</span></span>
<span><span class="co">#&gt; 10: unimportant5  0.9909342 0.01275179</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="leave-one-covariate-out-loco">Leave-One-Covariate-Out (LOCO)<a class="anchor" aria-label="anchor" href="#leave-one-covariate-out-loco"></a>
</h2>
<p>LOCO measures importance by retraining the model without each feature
and comparing performance to the full model. This shows the contribution
of each feature when all other features are present.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loco</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/LOCO.html">LOCO</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  task <span class="op">=</span> <span class="va">task</span>,</span>
<span>  learner <span class="op">=</span> <span class="va">learner</span>,</span>
<span>  measure <span class="op">=</span> <span class="va">measure</span>,</span>
<span>  resampling <span class="op">=</span> <span class="va">resampling</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">loco_results</span> <span class="op">&lt;-</span> <span class="va">loco</span><span class="op">$</span><span class="fu">compute</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">loco_results</span></span>
<span><span class="co">#&gt; Key: &lt;feature&gt;</span></span>
<span><span class="co">#&gt;          feature importance        sd</span></span>
<span><span class="co">#&gt;           &lt;char&gt;      &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:   important1  3.5341950 0.4799813</span></span>
<span><span class="co">#&gt;  2:   important2  5.5076635 0.8946863</span></span>
<span><span class="co">#&gt;  3:   important3  0.8231575 0.4514476</span></span>
<span><span class="co">#&gt;  4:   important4  7.5628028 1.7412825</span></span>
<span><span class="co">#&gt;  5:   important5  0.7647955 0.7375444</span></span>
<span><span class="co">#&gt;  6: unimportant1 -0.3884817 0.4774518</span></span>
<span><span class="co">#&gt;  7: unimportant2 -0.3159022 0.1183964</span></span>
<span><span class="co">#&gt;  8: unimportant3 -0.1991742 0.4288578</span></span>
<span><span class="co">#&gt;  9: unimportant4 -0.3039987 0.3220437</span></span>
<span><span class="co">#&gt; 10: unimportant5 -0.3435275 0.5206174</span></span></code></pre></div>
<p>LOCO is computationally expensive (requires retraining for each
feature) but provides clear interpretation: higher values mean larger
performance drop when the feature is removed. <strong>Important
limitation</strong>: LOCO cannot distinguish between direct effects and
indirect effects through correlated features.</p>
</div>
<div class="section level2">
<h2 id="feature-samplers">Feature Samplers<a class="anchor" aria-label="anchor" href="#feature-samplers"></a>
</h2>
<p>For advanced methods that account for feature dependencies, xplainfi
provides different sampling strategies. While PFI uses simple
permutation (marginal sampling), conditional samplers can preserve
feature relationships.</p>
<p>Let’s demonstrate conditional sampling using Adversarial Random
Forests, which preserves relationships between features when
sampling:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arf_sampler</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/ARFSampler.html">ARFSampler</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">task</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="va">task</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span>rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">sample_data</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">y</span>, <span class="va">important1</span>, <span class="va">important2</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;           y important1  important2</span></span>
<span><span class="co">#&gt;       &lt;num&gt;      &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 20.59935  0.2875775 0.784575267</span></span>
<span><span class="co">#&gt; 2: 10.48474  0.7883051 0.009429905</span></span>
<span><span class="co">#&gt; 3: 19.99049  0.4089769 0.779065883</span></span>
<span><span class="co">#&gt; 4: 19.70521  0.8830174 0.729390652</span></span>
<span><span class="co">#&gt; 5: 21.94251  0.9404673 0.630131853</span></span></code></pre></div>
<p>Now we’ll conditionally sample the <code>important1</code> feature
given the values of <code>important2</code> and
<code>important3</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sampled_conditional</span> <span class="op">&lt;-</span> <span class="va">arf_sampler</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span></span>
<span>  feature <span class="op">=</span> <span class="st">"important1"</span>, </span>
<span>  data <span class="op">=</span> <span class="va">sample_data</span>,</span>
<span>  conditioning_set <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"important2"</span>, <span class="st">"important3"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; opt: <span style="color: #0000BB;">NA</span>, env: <span style="color: #0000BB;">NA</span></span></span>
<span><span class="co">#&gt; opt: , env:</span></span>
<span></span>
<span><span class="va">sample_data</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">y</span>, <span class="va">important1</span>, <span class="va">important2</span>, <span class="va">important3</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;           y important1  important2 important3</span></span>
<span><span class="co">#&gt;       &lt;num&gt;      &lt;num&gt;       &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 20.59935  0.2875775 0.784575267  0.2372297</span></span>
<span><span class="co">#&gt; 2: 10.48474  0.7883051 0.009429905  0.6864904</span></span>
<span><span class="co">#&gt; 3: 19.99049  0.4089769 0.779065883  0.2258184</span></span>
<span><span class="co">#&gt; 4: 19.70521  0.8830174 0.729390652  0.3184946</span></span>
<span><span class="co">#&gt; 5: 21.94251  0.9404673 0.630131853  0.1739838</span></span>
<span><span class="va">sampled_conditional</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">y</span>, <span class="va">important1</span>, <span class="va">important2</span>, <span class="va">important3</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;           y important1  important2 important3</span></span>
<span><span class="co">#&gt;       &lt;num&gt;      &lt;num&gt;       &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 20.59935  0.2666614 0.784575267  0.2372297</span></span>
<span><span class="co">#&gt; 2: 10.48474  0.2551529 0.009429905  0.6864904</span></span>
<span><span class="co">#&gt; 3: 19.99049  0.4023150 0.779065883  0.2258184</span></span>
<span><span class="co">#&gt; 4: 19.70521  1.0645308 0.729390652  0.3184946</span></span>
<span><span class="co">#&gt; 5: 21.94251  0.6319506 0.630131853  0.1739838</span></span></code></pre></div>
<p>This conditional sampling is essential for methods like CFI and RFI
that need to preserve feature dependencies. See
<code>vignette("perturbation-importance")</code> for detailed
comparisons.</p>
</div>
<div class="section level2">
<h2 id="advanced-features">Advanced Features<a class="anchor" aria-label="anchor" href="#advanced-features"></a>
</h2>
<p>xplainfi supports many advanced features for robust importance
estimation:</p>
<ul>
<li>
<strong>Multiple resampling strategies</strong>: Cross-validation,
bootstrap, custom splits</li>
<li>
<strong>Multiple permutation/refit iterations</strong>: For more
stable estimates</li>
<li>
<strong>Feature grouping</strong>: Compute importance for groups of
related features</li>
<li>
<strong>Different relation types</strong>: Difference vs. ratio
scoring</li>
<li>
<strong>Conditional sampling</strong>: Account for feature
dependencies (see <code>vignette("perturbation-importance")</code>)</li>
<li>
<strong>SAGE methods</strong>: Shapley-based approaches (see
<code>vignette("sage-methods")</code>)</li>
</ul>
</div>
<div class="section level2">
<h2 id="detailed-scoring-information">Detailed Scoring Information<a class="anchor" aria-label="anchor" href="#detailed-scoring-information"></a>
</h2>
<p>All methods store detailed scoring information for further analysis.
Let’s examine the structure of PFI’s detailed scores:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pfi</span><span class="op">$</span><span class="va">scores</span>, <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span>, caption <span class="op">=</span> <span class="st">"Detailed PFI scores (first 10 rows)"</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<caption>Detailed PFI scores (first 10 rows)</caption>
<colgroup>
<col width="15%">
<col width="14%">
<col width="14%">
<col width="20%">
<col width="20%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="left">feature</th>
<th align="right">iter_rsmp</th>
<th align="right">iter_perm</th>
<th align="right">regr.mse_orig</th>
<th align="right">regr.mse_perm</th>
<th align="right">importance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">important1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4.3358</td>
<td align="right">8.4459</td>
<td align="right">4.1102</td>
</tr>
<tr class="even">
<td align="left">important1</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">7.7130</td>
<td align="right">12.7265</td>
<td align="right">5.0135</td>
</tr>
<tr class="odd">
<td align="left">important1</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">6.1924</td>
<td align="right">11.6449</td>
<td align="right">5.4525</td>
</tr>
<tr class="even">
<td align="left">important2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4.3358</td>
<td align="right">10.9357</td>
<td align="right">6.6000</td>
</tr>
<tr class="odd">
<td align="left">important2</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">7.7130</td>
<td align="right">18.4671</td>
<td align="right">10.7541</td>
</tr>
<tr class="even">
<td align="left">important2</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">6.1924</td>
<td align="right">13.3055</td>
<td align="right">7.1130</td>
</tr>
<tr class="odd">
<td align="left">important3</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4.3358</td>
<td align="right">5.2284</td>
<td align="right">0.8926</td>
</tr>
<tr class="even">
<td align="left">important3</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">7.7130</td>
<td align="right">9.5961</td>
<td align="right">1.8831</td>
</tr>
<tr class="odd">
<td align="left">important3</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">6.1924</td>
<td align="right">6.7444</td>
<td align="right">0.5520</td>
</tr>
<tr class="even">
<td align="left">important4</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4.3358</td>
<td align="right">15.4558</td>
<td align="right">11.1200</td>
</tr>
</tbody>
</table>
<p>We can also summarize the scoring structure:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pfi</span><span class="op">$</span><span class="va">scores</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span></span>
<span>  features <span class="op">=</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">uniqueN</a></span><span class="op">(</span><span class="va">feature</span><span class="op">)</span>,</span>
<span>  resampling_folds <span class="op">=</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">uniqueN</a></span><span class="op">(</span><span class="va">iter_rsmp</span><span class="op">)</span>, </span>
<span>  permutation_iters <span class="op">=</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">uniqueN</a></span><span class="op">(</span><span class="va">iter_perm</span><span class="op">)</span>,</span>
<span>  total_scores <span class="op">=</span> <span class="va">.N</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;    features resampling_folds permutation_iters total_scores</span></span>
<span><span class="co">#&gt;       &lt;int&gt;            &lt;int&gt;             &lt;int&gt;        &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:       10                3                 1           30</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://lukasburk.de" class="external-link">Lukas Burk</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
